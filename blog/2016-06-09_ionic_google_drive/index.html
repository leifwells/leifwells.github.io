<!DOCTYPE html><html lang="en"><head><meta name="generator" content="Scully 0.0.90">
    <meta charset="utf-8">
    <title>Leif Wells: Blog-o-rama</title>
    <base href="/">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&amp;display=swap" rel="stylesheet">
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="stylesheet" href="styles.877b1d74a16e50324e73.css"><style></style><style>.main-nav[_ngcontent-hjh-c10]   .title-container[_ngcontent-hjh-c10]{background-color:#fff;box-shadow:1px 3px 3px #d3d3d3;color:#000;display:flex;flex-direction:column;height:60px;left:0;position:fixed;right:0;text-align:center;text-decoration:none;z-index:999}.main-nav[_ngcontent-hjh-c10]   .title-container[_ngcontent-hjh-c10]   .title[_ngcontent-hjh-c10]{font-size:1.4rem;line-height:1.5rem;margin-top:10px}@media (min-width:600px){.main-nav[_ngcontent-hjh-c10]   .title-container[_ngcontent-hjh-c10]   .title[_ngcontent-hjh-c10]{font-size:.8rem;line-height:.9rem;margin-top:10px}}.main-nav[_ngcontent-hjh-c10]   .title-container[_ngcontent-hjh-c10]   .sub-title[_ngcontent-hjh-c10]{display:none}@media (min-width:600px){.main-nav[_ngcontent-hjh-c10]   .title-container[_ngcontent-hjh-c10]   .sub-title[_ngcontent-hjh-c10]{display:inline;font-size:.6rem;line-height:.8rem;margin-top:20px}}@media (min-width:600px){.main-nav[_ngcontent-hjh-c10]   .title-container[_ngcontent-hjh-c10]{text-align:center;width:100vw}.main-nav[_ngcontent-hjh-c10]   .title-container[_ngcontent-hjh-c10]   .title[_ngcontent-hjh-c10]{font-size:2rem}}.main-nav[_ngcontent-hjh-c10]   .main-container[_ngcontent-hjh-c10]{background-color:#fff;padding-top:65px}.main-nav[_ngcontent-hjh-c10]   .main-container.dark-theme[_ngcontent-hjh-c10]{background-color:#4f4f4f}.main-nav[_ngcontent-hjh-c10]   .main-container[_ngcontent-hjh-c10]   .page-container[_ngcontent-hjh-c10]{background-color:#000;margin:0 15px}@media (min-width:600px){.main-nav[_ngcontent-hjh-c10]   .main-container[_ngcontent-hjh-c10]   .page-container[_ngcontent-hjh-c10]{margin:0 20%}}</style><style>.footer[_ngcontent-hjh-c9]{display:flex;flex-direction:column;text-align:center;width:100vw}.footer[_ngcontent-hjh-c9]   .copyright-container[_ngcontent-hjh-c9]{text-align:center;margin:0 25%;width:50%}.footer[_ngcontent-hjh-c9]   .copyright-container[_ngcontent-hjh-c9]   p[_ngcontent-hjh-c9]{font-size:.6rem;line-height:.8rem;margin:0;padding:0}</style><style>.social-media[_ngcontent-hjh-c8]{display:block;margin:0}.social-media[_ngcontent-hjh-c8]   .social-icon[_ngcontent-hjh-c8]{color:#000}.social-media[_ngcontent-hjh-c8]   ul.social-icons[_ngcontent-hjh-c8]{margin:0;padding:0}.social-media[_ngcontent-hjh-c8]   .social-icons[_ngcontent-hjh-c8]   li[_ngcontent-hjh-c8]{display:inline;vertical-align:top}.social-media[_ngcontent-hjh-c8]   .social-icons[_ngcontent-hjh-c8]   a[_ngcontent-hjh-c8]{color:#000;text-decoration:none}.social-media[_ngcontent-hjh-c8]   .fa-facebook[_ngcontent-hjh-c8]{padding:10px 14px;transition:.5s;background-color:#fff}.social-media[_ngcontent-hjh-c8]   .fa-facebook[_ngcontent-hjh-c8]:hover{background-color:#3d5b99}.social-media[_ngcontent-hjh-c8]   .fa-twitter[_ngcontent-hjh-c8]{padding:10px 12px;transition:.5s;background-color:#fff}.social-media[_ngcontent-hjh-c8]   .fa-twitter[_ngcontent-hjh-c8]:hover{background-color:#00aced}.social-media[_ngcontent-hjh-c8]   .fa-rss[_ngcontent-hjh-c8]{padding:10px 14px;transition:.5s;background-color:#fff}.social-media[_ngcontent-hjh-c8]   .fa-rss[_ngcontent-hjh-c8]:hover{background-color:#eb8231}.social-media[_ngcontent-hjh-c8]   .fa-youtube[_ngcontent-hjh-c8]{padding:10px 14px;transition:.5s;background-color:#fff}.social-media[_ngcontent-hjh-c8]   .fa-youtube[_ngcontent-hjh-c8]:hover{background-color:#e64a41}.social-media[_ngcontent-hjh-c8]   .fa-linkedin[_ngcontent-hjh-c8]{padding:10px 14px;transition:.5s;background-color:#fff}.social-media[_ngcontent-hjh-c8]   .fa-linkedin[_ngcontent-hjh-c8]:hover{background-color:#0073a4}.social-media[_ngcontent-hjh-c8]   .fa-github[_ngcontent-hjh-c8]{padding:10px 14px;transition:.5s;background-color:#fff}.social-media[_ngcontent-hjh-c8]   .fa-github[_ngcontent-hjh-c8]:hover{background-color:#5a32a3}</style><style>.post-page[_ngcontent-hjh-c12]{display:flex;flex-direction:row;height:100%}@media (min-width:600px){.post-page[_ngcontent-hjh-c12]{margin:0 15vw}.post-page[_ngcontent-hjh-c12]   img[_ngcontent-hjh-c12]{padding:0 25px;width:45vw}}.post-page[_ngcontent-hjh-c12]   .post[_ngcontent-hjh-c12]{height:100%;width:100%}@media (min-width:600px){.post-page[_ngcontent-hjh-c12]   .post[_ngcontent-hjh-c12]{min-height:85vh;width:65vw}}.post-page[_ngcontent-hjh-c12]   .post[_ngcontent-hjh-c12]   .post-title[_ngcontent-hjh-c12]{margin:0 15px;font-size:1.5rem;line-height:1.8rem}@media (min-width:600px){.post-page[_ngcontent-hjh-c12]   .post[_ngcontent-hjh-c12]   .post-title[_ngcontent-hjh-c12]{margin:0 30px}}.post-page[_ngcontent-hjh-c12]   .post[_ngcontent-hjh-c12]   .post-date[_ngcontent-hjh-c12]{margin:0 15px;font-size:.8rem;line-height:1rem}@media (min-width:600px){.post-page[_ngcontent-hjh-c12]   .post[_ngcontent-hjh-c12]   .post-date[_ngcontent-hjh-c12]{margin:0 30px}}.post-page[_ngcontent-hjh-c12]   .post[_ngcontent-hjh-c12]   .article-body[_ngcontent-hjh-c12]{margin:0 15px}@media (min-width:600px){.post-page[_ngcontent-hjh-c12]   .post[_ngcontent-hjh-c12]   .article-body[_ngcontent-hjh-c12]{padding:0 15px}}.post-page[_ngcontent-hjh-c12]   .post[_ngcontent-hjh-c12]   .post-image-container[_ngcontent-hjh-c12]{background-color:grey;background-position:50% 25%;background-size:cover;height:120px}@media (min-width:600px){.post-page[_ngcontent-hjh-c12]   .post[_ngcontent-hjh-c12]   .post-image-container[_ngcontent-hjh-c12]{height:14rem}}.post-page[_ngcontent-hjh-c12]   .post[_ngcontent-hjh-c12]   img[_ngcontent-hjh-c12]{height:auto;width:95vw}@media (min-width:600px){.post-page[_ngcontent-hjh-c12]   .post[_ngcontent-hjh-c12]   img[_ngcontent-hjh-c12]{width:55vw}}.post-page[_ngcontent-hjh-c12]   .post[_ngcontent-hjh-c12]   img[_ngcontent-hjh-c12] + em[_ngcontent-hjh-c12]{font-style:normal;display:inherit;text-align:center;font-size:90%}.post-page[_ngcontent-hjh-c12]   .post[_ngcontent-hjh-c12]   pre[_ngcontent-hjh-c12]{background-color:#000;color:#fff;overflow:scroll;padding:15px}.post-page[_ngcontent-hjh-c12]   .post[_ngcontent-hjh-c12]   blockquote[_ngcontent-hjh-c12]{background-color:#dbdbdb;border-left:6px solid #a0a0a0;margin:10px;padding:10px}.post-page[_ngcontent-hjh-c12]   .post[_ngcontent-hjh-c12]   blockquote[_ngcontent-hjh-c12]   p[_ngcontent-hjh-c12]{margin-left:15px}</style><style>
      :host {
        display: none;
      }
      scully-content {
        display: none;
      }
    </style><script>window['ScullyIO']='generated';</script></head>
  <body scully-version="0.0.90">
    <app-root _nghost-hjh-c11="" ng-version="9.1.0"><app-main-nav _ngcontent-hjh-c11="" _nghost-hjh-c10=""><div _ngcontent-hjh-c10="" class="main-nav"><a _ngcontent-hjh-c10="" href="/index.html" class="title-container"><div _ngcontent-hjh-c10="" class="title">Leif's Development Blog-o-rama</div><div _ngcontent-hjh-c10="" class="sub-title"> This is the place where Leif writes stuff down for other developers to read. Also, it is how he remembers stuff. And things. </div></a><div _ngcontent-hjh-c10="" class="main-container"><router-outlet _ngcontent-hjh-c10=""></router-outlet><app-blog _nghost-hjh-c12=""><div _ngcontent-hjh-c12="" class="post-page">
  <article _ngcontent-hjh-c12="" class="post">
    <header _ngcontent-hjh-c12="">
      <div _ngcontent-hjh-c12="" width="{!(isHandset$ | async) ? '630px' : '100vw'}" height="{!(isHandset$ | async) ? '120px' : 'auto'}" class="post-image-container" style="background-image: url(&quot;/assets/images/2016-08-07-flowers.jpg&quot;);"></div>
      <h1 _ngcontent-hjh-c12="" class="post-title">Ionic 2 &amp; Angular 2: Using a Google Spreadsheet as a Data Source</h1>
      <h3 _ngcontent-hjh-c12="" class="post-date"><i _ngcontent-hjh-c12="" class="fa fa-calendar-check-o"></i> Jun 9, 2016 <!----></h3>
    </header>
    <div _ngcontent-hjh-c12="" class="article-body">
      <!--scullyContent-begin--><p _ngcontent-hjh-c12="">This week I was asked by my friend <a href="https://chrisgriffith.wordpress.com/" _ngcontent-hjh-c12="">Chris Griffith</a> about using a Google spread sheet as a data source for a prototype he was building. Both Chris and I build prototypes as part of our daily jobs, so the question makes sense; what happens when you need to use archived data -- data that you need will need to update from time to time -- but you don't have the time to build a server application or use something like Firebase to deliver the content?</p>
<p _ngcontent-hjh-c12="">Certainly you may use a JSON file, but managing and maintaining this file can be a pain. It also doesn't give a real online experience. So, off I went to The Googles to see what was out there on this topic.</p>
<p _ngcontent-hjh-c12="">Chris threw a <a href="https://ctrlq.org/code/20004-google-spreadsheets-json" _ngcontent-hjh-c12="">JQuery-specific on this subject link</a> at me. Thanks to <a href="https://ctrlq.org/" _ngcontent-hjh-c12="">Amit Agarwal</a> for blogging. If you'd like to give him some support there are some Google scripts for purchase on his site.</p>
<p _ngcontent-hjh-c12="">Using this technique we create a publicly viewable spread sheet and access it using Ionic 2 without using an API key, just the id of the spread sheet.</p>
<blockquote _ngcontent-hjh-c12="">
<p _ngcontent-hjh-c12=""><strong _ngcontent-hjh-c12="">Caveat:</strong> If you use this technique for creating a data source using a Google spread sheet please be advised that this spread sheet will be public. Please consider the data you are using with this technique and do not put anyone's private data at risk. While the spread sheet will only be available via a URL, that doesn't mean that someone won't be able to find it. You can <a href="https://www.google.com/search?q=automated+user+creation&amp;oq=atomated+user+crea&amp;aqs=chrome.1.69i57j0l5.5173j0j7&amp;sourceid=chrome&amp;ie=UTF-8#q=create+a+set+of+mock+users+to+fill+a+database" _ngcontent-hjh-c12="">use Google to find mock data generators online</a>.</p>
</blockquote>
<br _ngcontent-hjh-c12="">

<blockquote _ngcontent-hjh-c12="">
<p _ngcontent-hjh-c12=""><strong _ngcontent-hjh-c12="">Caveat:</strong> This code sample is built using Ionic 2 Beta 8 which was released earlier this week. I'll do my best to remember update this code sample when and if there are significant changes to the code in the future (or remember to remove this notice). This code sample uses TypeScript. I wholeheartedly endorse using TypeScript with Ionic 2 and Angular 2.</p>
</blockquote>
<h2 id="setting-up-a-spread-sheet" _ngcontent-hjh-c12="">Setting Up a Spread Sheet</h2>
<p _ngcontent-hjh-c12="">Here is my Google spread sheet:</p>
<iframe style="width: 100%" src="https://docs.google.com/spreadsheets/d/15Kndr-OcyCUAkBUcq6X3BMqKa_y2fMAXfPFLiSACiys/pubhtml?widget=true&amp;headers=false" _ngcontent-hjh-c12=""></iframe>

<br _ngcontent-hjh-c12="">

<p _ngcontent-hjh-c12="">Yeah, fairly simple, but this is an example post not a full application. Also notice that this is a live document, not an image. We've published this spread sheet on the Web via Google Drive.</p>
<p _ngcontent-hjh-c12="">We have a typical first row that holds the headers for the columns. Notice how I have named these headers as lowercase and without spaces. I've purposefully named these this way because they will end up as keys for our data source.</p>
<p _ngcontent-hjh-c12="">Now here comes the tricky part: setting it up to be available online. In Google Drive select the <code _ngcontent-hjh-c12="">File &gt; Publish to the Web...</code> option which will end up giving you a URL which has an id inside of it which is important. In our case the url looks like this:</p>
<p _ngcontent-hjh-c12=""><code _ngcontent-hjh-c12="">https://docs.google.com/spreadsheets/d/15Kndr-OcyCUAkBUcq6X3BMqKa_y2fMAXfPFLiSACiys/pubhtml</code></p>
<p _ngcontent-hjh-c12="">The id that is in this url is:</p>
<p _ngcontent-hjh-c12=""><code _ngcontent-hjh-c12="">15Kndr-OcyCUAkBUcq6X3BMqKa_y2fMAXfPFLiSACiys</code></p>
<blockquote _ngcontent-hjh-c12="">
<p _ngcontent-hjh-c12=""><strong _ngcontent-hjh-c12="">Important:</strong> Do NOT use Google Drive's blue Share button on the right-hand side of the tool bar for this technique. My results with using that sharing feature with this technique led to receiving JSON errors.</p>
</blockquote>
<h2 id="where-are-we-going" _ngcontent-hjh-c12="">Where Are We Going.</h2>
<p _ngcontent-hjh-c12="">Let's look at the results that are logged with our completed code so you can understand where we are going with this code sample:</p>
<p _ngcontent-hjh-c12=""><code _ngcontent-hjh-c12="">{{&lt;figure src="/images/2016-06-09_console_output.png" title="Figure 1: Console output for the Final Code Sample."&gt;}}</code></p>
<br _ngcontent-hjh-c12="">

<p _ngcontent-hjh-c12="">At the top you see under the "Raw Data" text the Object that you receive from Google using this technique. And, as JSON goes, it is verbose. But the opened nodes are the ones we are focusing on here. Take a look at the <code _ngcontent-hjh-c12="">Object &gt; feed &gt; entry</code> node. This is where your spread sheet data resides.</p>
<p _ngcontent-hjh-c12="">The entry node is an Array of Objects representing the row of data in the spread sheet. Notice the keys that are prefixed with <code _ngcontent-hjh-c12="">gsx$</code>: these are the nodes that contain the row content. For example, the <code _ngcontent-hjh-c12="">gsx$firstname</code> key represents the firstname column of that row. Now you can see why I mentioned the naming of the headers in the first row.</p>
<p _ngcontent-hjh-c12="">Now notice that the <code _ngcontent-hjh-c12="">gsx$firstname</code> key points to an object contain an key of <code _ngcontent-hjh-c12="">$t</code>. That is the property we are wanting to retrieve.</p>
<p _ngcontent-hjh-c12="">I could have focused on the <code _ngcontent-hjh-c12="">Object &gt; feed &gt; entry &gt; content</code> node, but I decided this was the way to go.</p>
<p _ngcontent-hjh-c12="">At the bottom of Figure 1 you also see the Array that we use in the view component.</p>
<h2 id="creating-the-provider" _ngcontent-hjh-c12="">Creating the Provider</h2>
<p _ngcontent-hjh-c12="">I used the Ionic CLI's <a href="http://ionicframework.com/docs/v2/cli/generate/" _ngcontent-hjh-c12="">generate command</a> to create my provider and added some code to process the incoming data. Lets take a look at it:</p>
<script src="https://gist.github.com/leifwells/7d5b7a8bb4bf0130d9faf1434ba953b8.js" _ngcontent-hjh-c12=""></script>

<p _ngcontent-hjh-c12="">Most of this code is boilerplate. The interesting part of this code resides inside the <code _ngcontent-hjh-c12="">subscribe()</code> where the data is processed.</p>
<blockquote _ngcontent-hjh-c12="">
<p _ngcontent-hjh-c12=""><strong _ngcontent-hjh-c12="">Confession:</strong> I am still working on gaining the skills necessary for modern Javascript Array processing. This code example is how I solved this problem, but if there are better ways of processing this data please let me know.</p>
</blockquote>
<p _ngcontent-hjh-c12="">In that code we loop through the <code _ngcontent-hjh-c12="">data.feed.entry</code> node, find the items that are prefixed with <code _ngcontent-hjh-c12="">gsx$</code> (and error checks that the subitem contains a <code _ngcontent-hjh-c12="">$t</code> key) and processes the key stripping away the prefix and creates a typical key/value object which is pushed into our <code _ngcontent-hjh-c12="">returnArray</code>.</p>
<p _ngcontent-hjh-c12="">It may be a little much for beginners to take in, but I think careful review of the code should reveal the code's simplicity.</p>
<h2 id="the-component-code" _ngcontent-hjh-c12="">The Component Code</h2>
<p _ngcontent-hjh-c12="">Now lets look at the code in Component that calls this provider:</p>
<script src="https://gist.github.com/leifwells/b12ed12f85bd2b3aef8d5ac507e8be89.js" _ngcontent-hjh-c12=""></script>

<p _ngcontent-hjh-c12="">Since this data is static we are only retrieving this data once so we are making the call inside out <code _ngcontent-hjh-c12="">construtor</code> method. If we wanted to retrieve this data upon every time the view is loaded, we would leverage the new Ionic lifecycle event <code _ngcontent-hjh-c12="">ionViewLoaded</code>. Take a look at <a href="http://ionicframework.com/docs/v2/api/components/nav/NavController/" _ngcontent-hjh-c12="">the lifecycle events in the NavController documentation</a>.</p>
<p _ngcontent-hjh-c12="">Also note that we have placed the spread sheet id inside this component. There are many ways to provide a separation of concerns in providers. We are placing the id of the spread sheet outside of the provider so that there is no need for any decision-making about which spread sheet to load. Another option would use constants inside our provider to hold the ids and expose those constants to our view.</p>
<h2 id="summary" _ngcontent-hjh-c12="">Summary</h2>
<p _ngcontent-hjh-c12="">In this article we created and published a spread sheet on Google Drive and leveraged it as a data source in an Ionic 2 / Angular 2. Feel free to comment below or contact me on Twitter if you have questions or comments.</p>
<p _ngcontent-hjh-c12=""><a href="https://twitter.com/leifwells" class="twitter-follow-button" data-show-count="false" data-size="large" _ngcontent-hjh-c12="">Follow @leifwells</a></p>
<script _ngcontent-hjh-c12="">!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
<!--scullyContent-end--><script>try {window['scullyContent'] = {cssId:"_ngcontent-hjh-c12",html:document.body.innerHTML.split('<!--scullyContent-begin-->')[1].split('<!--scullyContent-end-->')[0]};} catch(e) {console.error('scully could not parse content');}</script><scully-content _ngcontent-hjh-c12=""></scully-content>
    </div>
  </article>
  
</div>
</app-blog><!----></div><app-footer _ngcontent-hjh-c10="" _nghost-hjh-c9=""><div _ngcontent-hjh-c9="" class="footer"><app-social-media _ngcontent-hjh-c9="" _nghost-hjh-c8=""><div _ngcontent-hjh-c8="" class="social-media"><ul _ngcontent-hjh-c8="" class="social-icons"><li _ngcontent-hjh-c8=""><a _ngcontent-hjh-c8="" href="https://twitter.com/leifwells" class="social-icon"><i _ngcontent-hjh-c8="" class="fa fa-twitter"></i></a></li><li _ngcontent-hjh-c8=""><a _ngcontent-hjh-c8="" href="https://www.linkedin.com/in/leifwells/" class="social-icon"><i _ngcontent-hjh-c8="" class="fa fa-linkedin"></i></a></li><li _ngcontent-hjh-c8=""><a _ngcontent-hjh-c8="" href="https://github.com/leifwells" class="social-icon"><i _ngcontent-hjh-c8="" class="fa fa-github"></i></a></li></ul></div></app-social-media><div _ngcontent-hjh-c9="" class="copyright-container"><p _ngcontent-hjh-c9=""> Copyright © Leif Wells, leifwells.github.io and leifwells.com, 2016. </p><p _ngcontent-hjh-c9=""> Unauthorized use and/or duplication of this material without express and written permission from this site’s author and/or owner is strictly prohibited. Excerpts and links may be used, provided that full and clear credit is given to Leif Wells, leifwells.github.io and leifwells.com with appropriate and specific direction to the original content. </p></div></div></app-footer></div></app-main-nav></app-root>
  <script id="ScullyIO-transfer-state"></script>

</body></html>